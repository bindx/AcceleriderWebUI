webpackJsonp([1],[,,,,,function(e,t,n){"use strict";var r=n(2);t.a=new r.default},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(2),s=n(127),o=n(115),i=n.n(o),a=n(116),l=n.n(a),u=n(117),c=n.n(u),d=n(114),f=n.n(d),p=n(111),m=n.n(p),g=n(110),v=n.n(g),h=n(112),_=n.n(h),k=n(113),b=n.n(k);r.default.use(s.a);var w=new s.a({routes:[{path:"/",name:"Hello",component:i.a,children:[]},{path:"/login",name:"Login",component:l.a},{path:"/main",name:"Main",component:c.a,beforeEnter:function(e,t,n){sessionStorage.getItem("accessToken")?n():n({path:"/login",query:{redirect:e.fullPath}})}},{path:"/disk",name:"disk",component:f.a,beforeEnter:function(e,t,n){sessionStorage.getItem("accessToken")||sessionStorage.getItem("accessUk")?n():n({path:"/login",query:{redirect:e.fullPath}})}}]});r.default.component("register-form",m.a),r.default.component("login-form",v.a),r.default.component("user-info",_.a),r.default.component("web-disk",b.a),t.a=w},,function(e,t){},function(e,t,n){n(106);var r=n(4)(n(75),n(120),null,null);e.exports=r.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app",data:function(){return{msg:"TEST"}},methods:{testFunc:function(){}},created:function(){},mounted:function(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default={name:"loginform",data:function(){return{sumitstr:"LOGIN!",registerstr:"REGISTER",username:"",pwd:"",loginLoading:!1}},methods:{parseRep:function(e){this.loginLoading=!1;var t=e.data;if(0==t.errno){var n=t.token;sessionStorage.setItem("accessToken",n),r.a.$emit("loginsuccess","OK")}else this.$message.error(t.message)},register:function(){r.a.$emit("wantregister","OK")},login:function(){var e=this;this.loginLoading=!0;this.$ajax({method:"POST",url:"/login",params:{security:"express"},transformRequest:[function(e){var t="";for(var n in e)t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])+"&";return t}],data:{name:encodeURIComponent(this.username),password:this.pwd}}).then(function(t){return e.parseRep(t)}).catch(function(t){if(t.response){var n=t.response;e.parseRep(n)}else console.log("Error",t.message)})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default={name:"registerform",data:function(){return{sumitstr:"REGISTER!",username:"",pwd:"",regLoading:!1}},methods:{parseRep:function(e){this.loginLoading=!1;var t=e.data,n=t.errno;this.regLoading=!1,0==n?(this.$message(t.message),r.a.$emit("registersuccess","OK")):this.$message.error(t.message)},register:function(){var e=this;this.regLoading=!0;this.$ajax({method:"POST",url:"/signup",params:{security:"express"},transformRequest:[function(e){var t="";for(var n in e)t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])+"&";return t}],data:{name:encodeURIComponent(this.username),password:this.pwd}}).then(function(t){return e.parseRep(t)}).catch(function(t){if(t.response){var n=t.response;e.parseRep(n)}else console.log("Error",t.message)})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default={name:"userinfo",data:function(){return{userInfos:[],infoLoading:!0}},methods:{gotoDisk:function(e){this.getToken();sessionStorage.setItem("accessUk",e),r.a.$emit("godisk",e)},getToken:function(){return sessionStorage.getItem("accessToken")},getUserInfo:function(e){var t=this.getToken();return this.$ajax({method:"GET",url:"/userinfo",params:{token:t,uk:e}}).then(function(t){t=t.data;var n={};return n.uk=e,n.Name=t.username,n.nick_name=t.nick_name,n.total=t.total/1024/1024/1024,n.free=t.free/1024/1024/1024,n.used=t.used/1024/1024/1024,n.used=n.used.toFixed(2),n})},getUserList:function(){var e=this;this.userInfos=[];var t=this.getToken();this.$ajax({method:"GET",url:"/userlist",params:{token:t}}).then(function(t){var n=t.data;n.errno;return r.a.$emit("isbinding",n.userlist.length),0!=n.userlist.length&&n.userlist.map(function(t){t.Name=unescape(t.Name.replace(/\\u/g,"%u")),t.Token=e.getToken()}),n.userlist}).then(function(t){return t.map(function(t){return e.getUserInfo(t.Uk)})}).then(function(t){e.infoLoading=!1;for(var n in t)t[n].then(function(t){e.userInfos.push(t)})}).catch(function(t){if(e.infoLoading=!1,t.response){var n=t.response.data;e.$message.error(n.message)}else console.log(t)})}},mounted:function(){this.getUserList()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(85),s=n.n(r),o=n(5);t.default={name:"webdisk",data:function(){return{isLoading:!0,curPath:[],fileList:[],dialogDL:!1,dialogProP:!1,downlinks:[],curFile:{}}},methods:{parseBreadCrumb:function(e){var t="全部文件";return e.length>1&&(t=e[e.length-1]),t=t.split("/"),t[0]="全部文件",t},parseDownLinks:function(e){if(0==e.errno){var t=e.links;for(var n in t){var r={name:decodeURIComponent(n),urls:t[n]};this.downlinks.push(r)}}else console.log("errno",e.errno)},goFileList:function(e){var t=this,n="网盘 "+e;this.downlinks=[],this.isLoading=!0;var r=sessionStorage.getItem("accessToken"),s=sessionStorage.getItem("accessUk");this.$ajax({method:"GET",url:"/filelist",params:{token:r,uk:s,path:encodeURIComponent(e)}}).then(function(e){return e.data}).then(function(e){return e.list}).then(function(r){t.title=n,t.curPath.push(e),t.isLoading=!1,t.fileList=r}).catch(function(e){var t=e.response.data;t.errno;console.log(t.message)})},goMainForm:function(){o.a.$emit("gomain","back")},backFileList:function(){var e=this.curPath,t="/";e.length>1&&e.pop(),t=e.pop(),this.goFileList(t)},transeSize:function(e){if(1==e.isdir)return"--";var t=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=e.size,r=Math.floor(Math.log(n)/Math.log(1024));return(n/Math.pow(1024,r)).toFixed(2)+" "+t[r]},transeTime:function(e){var t=new Date;return t.setTime(1e3*e),t.toLocaleString()},fileProperty:function(e){this.curFile=e,this.dialogProP=!0},openDownLinks:function(e){var t=this;this.curFile=e,this.downlinks=[],this.dialogDL=!0;var n=sessionStorage.getItem("accessToken"),r=sessionStorage.getItem("accessUk"),o=e.size>31457280?"JUMP":"APPID",i={path:encodeURIComponent(e.path),id:e.fs_id};this.$ajax({method:"POST",url:"/filelinks",params:{token:n,uk:r,method:o},transformRequest:[function(e){var t="";for(var n in e)t+=n+"="+e[n];return t}],data:{files:"["+s()(i)+"]"}}).then(function(e){return e.data}).then(function(e){t.parseDownLinks(e)}).catch(function(e){if(e.response){var t=e.response.data;console.log(t.message)}else console.log(e)})}},mounted:function(){this.goFileList("/")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default={name:"disk",created:function(){var e=this;r.a.$on("gomain",function(t){e.$router.push({path:"/main"})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"hello",data:function(){return{linkLogin:"通往新世界的大门!"}},methods:{GO:function(){this.$router.push({path:"/main"})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default={name:"login",data:function(){return{isReg:!1}},created:function(){var e=this;r.a.$on("loginsuccess",function(t){e.$router.push({path:"/main"})}),r.a.$on("registersuccess",function(t){e.isReg=!1}),r.a.$on("wantregister",function(t){e.$confirm("你想注册?","提示",{type:"info"}).then(function(){e.isReg=!0}).catch(function(){})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default={name:"main",data:function(){return{errMsg:"获取账户列表失败，请先绑定账户!",binding:!0}},methods:{loginout:function(){sessionStorage.removeItem("accessToken"),this.$router.push({path:"/login"})}},created:function(){var e=this;r.a.$on("godisk",function(t){e.$router.push({path:"/disk"})}),r.a.$on("isbinding",function(t){e.binding=0!=t})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),s=n(35),o=n.n(s),i=n(32),a=n(31),l=n.n(a),u=n(33),c=n.n(u),d=n(34);n.n(d);r.default.config.productionTip=!1,r.default.prototype.$ajax=l.a.create({baseURL:"http://api.pescn.top/",headers:{}}),r.default.use(c.a),new r.default({el:"#app",router:i.a,template:"<App/>",components:{App:o.a}})},,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},,function(e,t,n){var r=n(4)(n(76),n(122),null,null);e.exports=r.exports},function(e,t,n){var r=n(4)(n(77),n(125),null,null);e.exports=r.exports},function(e,t,n){n(107);var r=n(4)(n(78),n(121),"data-v-1a92407d",null);e.exports=r.exports},function(e,t,n){n(105);var r=n(4)(n(79),n(119),"data-v-0494d05d",null);e.exports=r.exports},function(e,t,n){var r=n(4)(n(80),n(126),null,null);e.exports=r.exports},function(e,t,n){n(108);var r=n(4)(n(81),n(124),"data-v-9cecf088",null);e.exports=r.exports},function(e,t,n){var r=n(4)(n(82),n(118),null,null);e.exports=r.exports},function(e,t,n){var r=n(4)(n(83),n(123),null,null);e.exports=r.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"content",attrs:{align:"center"}},[n("login-form"),n("el-dialog",{model:{value:e.isReg,callback:function(t){e.isReg=t},expression:"isReg"}},[n("register-form")],1)],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"disk"},[n("el-row",{staticClass:"path-status"},[n("el-button",{attrs:{icon:"arrow-left"},on:{click:e.backFileList}}),n("el-breadcrumb",{attrs:{separator:">",replace:!0}},[e._l(e.parseBreadCrumb(e.curPath),function(t){return n("el-breadcrumb-item",{key:"p"},[e._v(e._s(t))])}),e._v("Total: "+e._s(e.fileList.length))],2),n("el-button",{on:{click:e.goMainForm}},[e._v("回到主页")])],1),n("div",{staticClass:"disk-table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],attrs:{data:e.fileList}},[n("el-table-column",{attrs:{label:"文件名"},scopedSlots:e._u([["default",function(t){return[0==t.row.isdir?n("div",{staticStyle:{float:"left"},style:{cursor:"default"}},[n("span",[e._v(e._s(t.row.server_filename))])]):e._e(),1==t.row.isdir?n("div",{staticStyle:{float:"left"}},[n("el-button",{style:{cursor:"pointer"},attrs:{type:"text"},on:{click:function(n){e.goFileList(t.row.path)}}},[e._v(e._s(t.row.server_filename))])],1):e._e(),n("div",{staticStyle:{float:"right"}},[n("el-button",{attrs:{type:"text",icon:"arrow-down"},on:{click:function(n){e.openDownLinks(t.row)}}}),n("el-button",{attrs:{type:"text",icon:"more"},on:{click:function(n){e.fileProperty(t.row)}}})],1)]}]])}),n("el-table-column",{attrs:{label:"大小"},scopedSlots:e._u([["default",function(t){return[e._v(e._s(e.transeSize(t.row)))]}]])}),n("el-table-column",{attrs:{label:"修改日期"},scopedSlots:e._u([["default",function(t){return[e._v(e._s(e.transeTime(t.row.server_mtime)))]}]])})],1)],1),n("div",{staticClass:"dialog"},[n("el-dialog",{attrs:{title:"下载链接"},model:{value:e.dialogDL,callback:function(t){e.dialogDL=t},expression:"dialogDL"}},e._l(e.downlinks,function(t){return n("div",[n("p",[e._v(e._s(e.curFile.server_filename))]),n("ul",e._l(t.urls,function(t){return n("li",[n("a",{attrs:{href:t,target:"_blank"}},[e._v("链接")])])}))])})),n("el-dialog",{attrs:{title:"文件属性"},model:{value:e.dialogProP,callback:function(t){e.dialogProP=t},expression:"dialogProP"}},[n("p",[e._v("文件名： "+e._s(e.curFile.server_filename))]),n("p",[e._v("文件大小： "+e._s(e.transeSize(e.curFile)))]),1==e.curFile.isdir?n("p",[e._v("是否有子目录： "+e._s(0==e.curFile.dir_empty))]):e._e(),n("p",[e._v("修改时间： "+e._s(e.transeTime(e.curFile.server_mtime)))]),0==e.curFile.isdir?n("p",[e._v("文件MD5： "+e._s(e.curFile.md5))]):e._e()])],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("transition",[n("router-view")],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.infoLoading,expression:"infoLoading"}],staticClass:"user-info"},[n("el-table",{attrs:{data:e.userInfos,border:"border"}},[n("el-table-column",{attrs:{prop:"Name",label:"昵称"}}),n("el-table-column",{attrs:{label:"用量(已用/总量)"},scopedSlots:e._u([["default",function(t){return[e._v(e._s(t.row.used)+"G/"+e._s(t.row.total)+"G")]}]])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([["default",function(t){return[n("el-button",{staticClass:"operation-menu",attrs:{primary:"primary"},on:{click:function(n){e.gotoDisk(t.row.uk)}}},[e._v("DISK")])]}]])})],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{staticClass:"login-form"},[n("el-form-item",{attrs:{label:"username"}},[n("el-input",{attrs:{id:"username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),n("el-form-item",{attrs:{label:"password"}},[n("el-input",{attrs:{id:"password",type:"password"},model:{value:e.pwd,callback:function(t){e.pwd=t},expression:"pwd"}})],1),n("el-form-item",[n("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loginLoading,expression:"loginLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.login}},[e._v(e._s(e.sumitstr))]),n("el-button",{attrs:{type:"text"},on:{click:e.register}},[e._v(e._s(e.registerstr))])],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e.binding?e._e():n("div",{staticClass:"err-info"},[e._v(e._s(e.errMsg))]),e.binding?n("div",{staticClass:"info"},[n("user-info")],1):e._e(),n("el-button",{attrs:{type:"text"},on:{click:function(t){e.loginout()}}},[e._v("返回登录")])],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"content",attrs:{align:"center"}},[n("el-button",{attrs:{type:"primary"},on:{click:e.GO}},[e._v(e._s(e.linkLogin))])],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.regLoading,expression:"regLoading"}],staticClass:"register-form",attrs:{label:"注册"}},[n("el-form-item",{attrs:{label:"username"}},[n("el-input",{attrs:{id:"username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),n("el-form-item",{attrs:{label:"password"}},[n("el-input",{attrs:{id:"password",type:"password"},model:{value:e.pwd,callback:function(t){e.pwd=t},expression:"pwd"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.register}},[e._v(e._s(e.sumitstr))])],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"content"},[n("web-disk")],1)])},staticRenderFns:[]}}],[84]);